--Rollup 함수
--자동으로 소계/합계를 구해주는 함수
--GroupBy절에 주어진 조건으로 소계구해준다

select deptno,position, sum(pay) from professor group by position,rollup(deptno); -- deptno 올림차순으로 정렬하며 각 pay를 구하고 마지막 정교수,조교수별 합계를 구한다
select position, sum(pay) from professor group by position;
select position, count(*), sum(pay) from professor group by rollup(position);

--cube 전체총합계에서 출력하려면 rollup처럼 각소계에 총계까지 구해준다
select deptno, count(*), sum(pay) from professor group by cube(deptno);

--emp에서 직업별 인원수 최대급여 최소급여를 구하세요
select job, count(*), max(sal), min(sal) from emp group by job order by job;

--emp에서 부서번호,인원수,급여평균,급여의 합 조회
select deptno,count(*),avg(sal) from emp group by rollup(deptno);

--입사년도별 인원수, sal의 평균(소수점없이) 출력하되 입사년도의 오름차순
select to_char(hiredate,'YYYY'), count(*), round(avg(sal)) from emp group by to_char(hiredate,'YYYY') order by to_char(hiredate,'YYYY');

insert into department (deptno,dname) values(102, '유아교육과');
insert into department (deptno,dname) values(103, '미술교육과');
insert into department (deptno,dname) values(201, '영어영문과');
insert into department (deptno,dname) values(202, '국어국문과');
delete from department where deptno = 10 or deptno = 20;

--[dml]


--professor에 데이터 입력
select * from professor;
insert into professor (profno,name,id,position,pay,hiredate,deptno) values(5001,'손흥민','loveme','정교수',500,sysdate,301); 
update professor set bonus = null;

--조교수들의 보너스를 일괄 100만원으로 인상해주세요
update professor set bonus = 100 where position = '조교수';

--손흥민교수와 동일한 직급을 가진 교수들중 500이 안되는 교수들의 급여를 15퍼 인상하세요
update professor set pay = pay*1.15 where position = (select position from professor where name ='손흥민') and pay < 500;

--dept2에서 부서번호 1001~1009 사이에 매장들을 모두 삭제해주세요
select * from dept2;
delete dept2 where dcode between 1001 and 1009;

--alter 테이블의 구조변경
select * from dept3; 
--dept3에 loc를 추가하고 기본값으로 대한민국이라고 넣을것
ALTER table dept3 add loc varchar2(20) default '대한민국';

--포항본사의 loc를 포항시청앞으로 수정
update dept3 set loc = '포항시청앞' where area = '포항본사';

update dept3 set loc = '광하문' where area = '서울지사';
update dept3 set loc = '울산시청' where area = '울산지사';

--emp테이블에 totsal 열을 하나 더 추가해주세요
select * from emp;
alter table emp add totsal number(20);

--1.sequence : seqshop (1부터 2씩 증가 캐쉬없음)

--2. 테이블 : Myshop
--no number(5) 기본키 (시퀸스)
--sangpum varchar2(30)
-- su number(10)
--price number(10)
--size carchar2(30)
--ipgoday date (오늘날짜)
--최소 5개 이상 insert해볼것

create SEQUENCE seqshop start with 1 increment by 2 nocache;

create table myshop ("no" number(5) primary key, sangpum varchar2(30), su number(10),prize number(10), "size" varchar2(30), ipgoday date);

select * from myshop;

insert into myshop values(seqshop.nextval , '사과' , 10 , 1000 , '크다', sysdate);
insert into myshop values(seqshop.nextval , '포도' , 5 , 7500 , '작다', sysdate);
insert into myshop values(seqshop.nextval , '바나나' , 20 , 5000 , '크다', sysdate);
insert into myshop values(seqshop.nextval , '키위' , 35 , 3000 , '작다', sysdate);
insert into myshop values(seqshop.nextval , '파인애플' , 50 , 15000 , '크다', sysdate);



update emp set totsal = sal + nvl(comm,0);

rollback;
commit;
